<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=1024, user-scalable=no">
    <title>Slides for
        Refactoring Rails in the Backend Development Textbook
    </title>
    <!-- Required stylesheet -->
    <link rel="stylesheet" media="screen" href="stylesheets/deck.core.css">
    <!-- Extension CSS files go here. Remove or add as needed. -->
    <link rel="stylesheet" media="screen" href="stylesheets/deck.goto.css">
    <link rel="stylesheet" media="screen" href="stylesheets/deck.menu.css">
    <link rel="stylesheet" media="screen" href="stylesheets/deck.navigation.css">
    <link rel="stylesheet" media="screen" href="stylesheets/deck.status.css">
    <!-- Style theme. More available in /themes/style/ or create your own. -->
    <link rel="stylesheet" media="screen" href="stylesheets/web-2.0.css">
    <!-- Transition theme. More available in /themes/transition/ or create your own. -->
    <link rel="stylesheet" media="screen" href="stylesheets/horizontal-slide.css">
    <!-- syntax highlighter -->
    <link rel="stylesheet" type="text/css" href="stylesheets/syntaxhighlighter/shCore.css" />
    <link rel="stylesheet" type="text/css" href="stylesheets/syntaxhighlighter/shThemeRailsGuides.css" />    


    <!-- Basic black and white print styles -->
    <link rel="stylesheet" media="print" href="stylesheets/print.css">
    <!-- Required Modernizr file -->
    <script src="javascripts/modernizr.custom.js"></script>
</head>

<body>
    <div class="deck-container">
        <div class='slide'><h2>Refactoring Rails</h2><p>This guide will show you how to refactor
your code.  </p><p>By referring to this guide, you will be able to:</p>
<ul>
<li>Get to know some tools that help you find problematic aspects of your code</li>
<li>Learn general refactoring practice from concrete examples</li>
</ul>

</div>
<div class='slide'>
<a class='slide_break' href='refactoring_rails.html#slide-1'>▻</a>
<h3 id="refactoring">1 Refactoring</h3>
<p>Never be ashamed of making you code better.  On the contrary: recognizing code smells
in your old code means that you learnt something in the meantime.
Only very inexperienced people think that the code they wrote yesterday is
perfect.</p>
<p>Refactoring is </p>
<ul>
<li>restructuring an existing body of code</li>
<li>altering its internal structure</li>
<li>without changing its external behavior <a href="https://en.wikipedia.org/wiki/Refactoring">wikipedia</a>
</li>
</ul>
<p>We will use <strong>tests</strong> to ensure that we do not change the external behavior 
of the code we are refactoring.</p>
<p>A <strong>code smell</strong> is a piece of bad code that we recognize.</p>
<p>Read the Ruby version of Fowlers refactoring book to 
learn both code smells and refactorings:</p>
</div>
<div class='slide'>
<a class='slide_break' href='refactoring_rails.html#slide-2'>▻</a>
<h3 id="code-smells">2 Code Smells</h3>
<p>This is the list of code smells from 
Fields, Harvie, Fowler(2010): Refactoring, Ruby Edition. Addison-Wesley.
In chapter 6 to 12 of that book they describe refactorings to handle
all these problems and more:</p>
<ul>
<li>Duplicated Code</li>
<li>Long Method</li>
<li>Large Class</li>
<li>Long Parameter List</li>
<li>Divergent Change</li>
<li>Shotgun Surgery</li>
<li>Feature Envy.</li>
<li>Data Clumps.</li>
<li>Primitive Obsession</li>
<li>Case Statements</li>
<li>Parallel Inheritance Hierarchies</li>
<li>Lazy Class.</li>
<li>Speculative Generality.</li>
<li>Temporary Field</li>
<li>Message Chains</li>
<li>Middle Man</li>
<li>Inappropriate Intimacy</li>
<li>Alternative Classes with Different Interfaces.</li>
<li>Incomplete Library Class</li>
<li>Data Class</li>
<li>Refused Bequest</li>
<li>Comments</li>
<li>Metaprogramming Madness</li>
<li>Disjointed API</li>
<li>Repetitive Boilerplate</li>
</ul>
</div>
<div class='slide'>
<a class='slide_break' href='refactoring_rails.html#slide-3'>▻</a>
<h3 id="tools-for-code-quality">3 Tools for Code Quality</h3>
<p>Recognizing code that is problematic and should be refactored
is one of the main skills of a developer.  Often it is not a
black and white situation: there might be several ways of writing
a certain piece of code, each with it's own pros and cons.<br>
A tool cannot help you make these decision.</p>
<p>But there is a role for tools in this process: especially when
faced with a lot of code there are tools that can help
you find places you should look at.</p>
<p>A <a href="https://en.wikipedia.org/wiki/Software_metric">code metric</a> is 
a quantitive measure of the quality of a piece of code.</p>
<p>The Gem <code>metric_fu</code> combines some metrics. Install it in your
Gemfile, and add a task-file, and run it on the command line <code>metriy_fu</code>.
It will generate a report in <code>tmp/metric_fu/output/</code>. </p>
<p><strong>Saikuro</strong> is a good place to start reading the report: it
measures  cyclomatic complexity, or how deep you nest your control structures.</p>
<p>See <a href="http://railscasts.com/episodes/166-metric-fu?view=asciicast">Rails Cast no
166</a> for a more
detailed introduction to metric_fu.</p>
<p>Another tool to help find spots where you can improve the quality of
your code is <code>rails_best_practices</code>.  Install the gem, but don't put
it in your <code>Gemfile</code>.  Just run <code>rails_best_practices -f html</code> in
the main directory of your app.  The result will be written to 
<code>./rails_best_practices_output.html</code>.</p>
</div>
<div class='slide'>
<a class='slide_break' href='refactoring_rails.html#slide-4'>▻</a>
<h3 id="futher-reading">4 Futher Reading</h3>
<ul>
<li>Fowler, Beck, Brant, Opdyke, Roberts(1999). Refactoring: improving the design of existing code. Addison Wesley. ISBN: 0-201-48567-2.</li>
<li>Fields, Harvie, Fowler(2010): Refactoring, Ruby Edition. Addison-Wesley.</li>
<li>
<a href="https://github.com/facebook/codemod">codemod</a> a python script</li>
</ul>
</div>
    </div>
    <!-- End slides. -->
    <!-- Begin extension snippets. Add or remove as needed. -->
    <!-- deck.navigation snippet -->
    <div aria-role="navigation">
        <a href="#" class="deck-prev-link" title="Previous">&#8592;</a>
        <a href="#" class="deck-next-link" title="Next">&#8594;</a>
    </div>
    <!-- deck.status snippet -->
    <p class="deck-status" aria-role="status">
        <span class="deck-status-current"></span>
        /
        <span class="deck-status-total"></span>
    </p>
    <!-- deck.goto snippet -->
    <form action="." method="get" class="goto-form">
        <label for="goto-slide">Go to slide:</label>
        <input type="text" name="slidenum" id="goto-slide" list="goto-datalist">
        <datalist id="goto-datalist"></datalist>
        <input type="submit" value="Go">
    </form>
    <!-- End extension snippets. -->
    </div>
    <!-- Required JS files. -->
    <script src="javascripts/jquery.min.js"></script>
    <script src="javascripts/deck.core.js"></script>
    <!-- Extension JS files. Add or remove as needed. -->
    <script src="javascripts/deck.menu.js"></script>
    <script src="javascripts/deck.goto.js"></script>
    <script src="javascripts/deck.status.js"></script>
    <script src="javascripts/deck.navigation.js"></script>
    <script src="javascripts/deck.escape.js"></script>
    <!--  Syntax highlighter -->
    <script src="javascripts/syntaxhighlighter/shCore.js"></script>
    <script src="javascripts/syntaxhighlighter/shBrushRuby.js"></script>
    <script src="javascripts/syntaxhighlighter/shBrushXml.js"></script>
    <script src="javascripts/syntaxhighlighter/shBrushSql.js"></script>
    <script src="javascripts/syntaxhighlighter/shBrushPlain.js"></script>    
    <!-- Initialize the deck. You can put this in an external file if desired. -->
    <script>
    SyntaxHighlighter.all()      
    $(function() {
      $.deck('.slide');
    });

    var $d = $(document);    

    $d.bind('deck.change', function(event, from, to) {
      // console.log('Moving from slide ' + from + ' to ' + to);
    });   
    $d.bind('deck.beforeInit', function() {
      // console.log('Deck.beforeInit. hash is ' + document.location.hash);
    });     
    $d.bind('deck.init', function() {
      // console.log('Deck.init is done. hash was ' + document.location.hash);
    }); 
    </script>
</body>

</html>